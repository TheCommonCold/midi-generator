{"version":3,"sources":["files/midi.mid","sound/rythm.js","sound/chords.js","sound/player.js","components/MidiDisplay.jsx","components/App.js","reportWebVitals.js","index.js"],"names":["rythms","maj","min","scales","major","notes","mode","chords","minor","createRandomProgression","lengths","length","currentLength","rythmStructure","diff","randomNumber","Math","floor","random","push","constructRythm","i","RandomChord","rythm","octave","scaleType","numberOfNotes","jazziness","scale","randomNote","rootNote","transposed","chord","note","includes","randomVoicing","map","x","gain","Tone","toDestination","filter","frequency","type","rolloff","Q","connect","synth","oscillator","count","spread","envelope","attack","decay","sustain","release","notesMap","playProgression","delay","setTimeout","duration","now","translatedNotes","toString","triggerAttack","releaseAll","playChord","makeGrid","height","progression","play","baseLine","cols","j","rows","style","width","reverse","Container","Row","className","Col","Button","onClick","MidiDisplay","progressions","useEffect","a","fetch","midiFile","response","reader","body","getReader","read","result","results","midiParser","parse","value","console","log","noteBeginnings","track","event","noteEndings","data","startTime","deltaTime","endTime","getData","App","Jumbotron","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d1656eb9.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/midi.9923a118.mid\";","const rythms = [1/2,3/4,1,3/2,2,3,4]\r\n// const lengths = [2,4,8]\r\n\r\nexport function constructRythm(length){\r\n    let currentLength = 0;\r\n    let rythmStructure = []\r\n    while(currentLength<length){\r\n        let diff = 0 ;\r\n        let randomNumber = Math.floor(Math.random() * rythms.length)\r\n\r\n        if(currentLength+rythms[randomNumber]-diff>length){\r\n            diff = length - currentLength\r\n            currentLength+=diff\r\n            rythmStructure.push(diff)\r\n            return rythmStructure\r\n        }\r\n\r\n        currentLength+=rythms[randomNumber]-diff\r\n        rythmStructure.push(rythms[randomNumber]-diff)\r\n    }\r\n\r\n    return rythmStructure\r\n}","import {constructRythm} from './rythm'\r\n\r\nconst maj = 'major'\r\nconst min = 'minor'\r\n\r\n\r\nconst scales = {\r\n    major: {\r\n        notes: [0,2,4,5,7,9,11],\r\n        mode: [maj,min, min, maj, maj, min, min]\r\n    }\r\n}\r\n\r\nconst chords = {\r\n    major:[0,4,7,2,11,18,21,13,20,15,22,17],\r\n    minor:[0,3,7,2,10,17,21,16,23,18,20,13]\r\n}\r\n\r\nexport function createRandomProgression(){\r\n    let chords = []\r\n    let lengths = constructRythm(8)\r\n    for(let i = 0; i<lengths.length; i++){\r\n        chords.push(RandomChord(0,'major',2,5))\r\n    }\r\n    return {chords, rythm: lengths}\r\n}\r\n\r\nexport function RandomChord(octave,scaleType,numberOfNotes, jazziness){\r\n    const scale = scales[scaleType]\r\n    const randomNote = Math.floor(Math.random() * scale.notes.length);\r\n\r\n    const mode = scale.mode[randomNote]\r\n    let rootNote = scale.notes[randomNote]\r\n\r\n    let chord = randomVoicing(mode, numberOfNotes,jazziness)\r\n\r\n    let transposed = chord.map(x => x + rootNote +36 + (12*octave))\r\n    if(Math.random()-(1/4)>rootNote/12)\r\n        rootNote+=12\r\n    transposed.push(rootNote+24)\r\n    transposed.push(rootNote+12)\r\n\r\n    return transposed\r\n}\r\n\r\nfunction randomVoicing(mode,numberOfNotes,jazziness=5){\r\n    let chord = []\r\n    for(let i = 0; i<numberOfNotes; i++){\r\n        let note = chords[mode][Math.floor(Math.random() * jazziness)];\r\n        if (chord.includes(note))\r\n        {\r\n            i--\r\n            continue\r\n        }\r\n        chord.push(note)\r\n    }\r\n    return chord\r\n}\r\n","import * as Tone from 'tone'\r\n\r\nconst gain = new Tone.Gain(0.2).toDestination();\r\nconst filter = new Tone.Filter({frequency: 1000, type: \"lowpass\", rolloff: -12, Q: 0}).connect(gain);\r\n\r\nconst synth = new Tone.PolySynth(Tone.Synth,{\r\n  oscillator : {\r\n    count: 2,\r\n    spread: 5,\r\n    type : \"sawtooth\",\r\n  },\r\n  // envelope: {\r\n  //   attack: 0.01,\r\n  //   decay: 15,\r\n  //   sustain: 0.20,\r\n  //   release: 0.1,\r\n  // },\r\n    envelope: {\r\n    attack: 0.002,\r\n    decay: 0,\r\n    sustain: 1,\r\n    release: 0.1,\r\n  },\r\n}).connect(filter);\r\n\r\nconst notesMap = [\r\n  'C',\r\n  'C#',\r\n  'D',\r\n  'D#',\r\n  'E',\r\n  'F',\r\n  'F#',\r\n  'G',\r\n  'G#',\r\n  'A',\r\n  'A#',\r\n  'B'\r\n]\r\n\r\nexport function playProgression(chords, rythm){\r\n  let lengths = rythm\r\n  let delay = 0\r\n  for(let i = 0; i<lengths.length; i++){\r\n      setTimeout(function(){ playChord(chords[i],lengths[i]); }, delay*1000);\r\n      delay += lengths[i]\r\n  }\r\n}\r\n\r\nexport function playChord(chord,duration){\r\n  const now = Tone.now()\r\n  const translatedNotes = translateNumbersIntoNotes(chord)\r\n  synth.triggerAttack(translatedNotes, now);\r\n  synth.releaseAll ( now + duration);\r\n}\r\n\r\nfunction translateNumbersIntoNotes(notes){\r\n  return notes.map(x => {\r\n    const octave = Math.floor(x/12);\r\n    const note = notesMap[x%12];\r\n    return note+octave.toString();\r\n  })\r\n}\r\n\r\nexport function noteOn(midiNote, duration) {\r\n\r\n  var ac = new window.AudioContext();\r\n  var o = ac.createOscillator();\r\n  var g = ac.createGain();\r\n  var f = ac.createBiquadFilter();\r\n  const freq = Math.pow(2, (midiNote-69)/12)*440;\r\n  o.frequency.value = freq;\r\n  o.type = 'sawtooth';\r\n  o.connect(g);\r\n  g.gain.value = 0.25;\r\n  g.connect(f);\r\n  f.frequency.value = 1000;\r\n  f.connect(ac.destination)\r\n  o.start(0);\r\n  setTimeout(function(s) {s.stop(0)}, duration, o);\r\n\r\n  // var ac = new (window.AudioContext || window.webkitAudioContext);\r\n  // var freqs = [261.63, 329.63, 392.00];\r\n  // for(var i=0;i<freqs.length;i++) {\r\n  //   var o = ac.createOscillator();\r\n  //   var g = ac.createGain();\r\n  //   o.frequency.value = freqs[i];\r\n  //   o.connect(g);\r\n  //   g.gain.value = 0.25;\r\n  //   g.connect(ac.destination);\r\n  //   o.start(0);\r\n  //   setTimeout(function(s) {s.stop(0)}, 1000, o);\r\n  // }\r\n}\r\n","import React, {useEffect} from 'react';\r\nimport '../style/App.css';\r\nimport midiFile from '../files/midi.mid';\r\nimport midiParser from 'midi-parser-js';\r\nimport {Container, Row, Col, Button} from 'reactstrap'\r\nimport {createRandomProgression} from '../sound/chords'\r\nimport {playProgression} from '../sound/player'\r\n\r\n\r\nfunction makeGrid(height=60, progression){\r\n\r\n  const play = () => {\r\n    playProgression(progression.chords, progression.rythm)\r\n  }\r\n\r\n  const baseLine = 12\r\n  let cols = []\r\n  let length = 0\r\n  for(let j = 0; j<progression.rythm.length; j++ ){\r\n    length+=progression.rythm[j]\r\n  }\r\n  for(let j = 0; j<progression.chords.length; j++ ){\r\n    const chord = progression.chords[j]\r\n    let rows = []\r\n    for(let i = baseLine; i<height+baseLine; i++ ){\r\n      if(chord.includes(i))\r\n        rows.push(\r\n          <div style={{height: (1/height*100).toString()+'%', width:'100%', \"background-color\":'red'}}>\r\n          </div>)\r\n      else\r\n        rows.push(\r\n          <div style={{height: (1/height*100).toString()+'%', width:'100%'}}>\r\n          </div>)\r\n    }\r\n    cols.push(<div style={{height: '100%', width: (progression.rythm[j]/length*100).toString()+'%'}}>{rows.reverse()}</div>)\r\n  }\r\n  return (<Container>\r\n    <Row>\r\n    <Row className='w-100' style={{height:\"200px\"}}>{cols}</Row>\r\n    <Col>\r\n      <Button className='w-100' onClick={play}>Play progression</Button>\r\n      </Col>\r\n    </Row>\r\n  </Container>)\r\n}\r\n\r\nfunction MidiDisplay() {\r\n  const progressions = [createRandomProgression(),createRandomProgression(),createRandomProgression(),createRandomProgression()]\r\n\r\n    useEffect(() => {\r\n        async function getData() {\r\n          const response = await fetch(midiFile)\r\n          const reader = response.body.getReader()\r\n          const result = await reader.read()\r\n          const results =  midiParser.parse(result.value)\r\n          console.log(results)\r\n          const noteBeginnings = results.track[0].event.filter(x => x.type===9 )\r\n          const noteEndings  = results.track[0].event.filter(x => x.type===8 )\r\n\r\n          let notes = []\r\n          for(let i = 0; i<noteBeginnings.length; i++){\r\n            for(let j = 0; j<noteBeginnings.length; j++){\r\n              if (noteBeginnings[i].data[0] === noteEndings[j].data[0]){\r\n                notes.push({note: noteBeginnings[i].data[0], startTime: noteBeginnings[i].deltaTime, endTime: noteEndings[j].deltaTime})\r\n              }\r\n            }\r\n          }\r\n\r\n        }\r\n        getData()\r\n      }, [])\r\n\r\n  return (\r\n    <Container>\r\n      <Row>\r\n        {progressions.map(progression => {\r\n          return (\r\n            <Col>\r\n            {makeGrid(48,progression)}\r\n          </Col>\r\n          )\r\n        })}\r\n      </Row>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default MidiDisplay;\r\n","import MidiDisplay from './MidiDisplay'\nimport '../style/App.css';\nimport {Jumbotron} from 'reactstrap'\n\n\nfunction App() {\n  return (\n    <Jumbotron>\n      <MidiDisplay/>\n    </Jumbotron>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './style/index.css';\nimport App from './components/App';\nimport reportWebVitals from './reportWebVitals';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}