(this["webpackJsonpmidi-generator"]=this["webpackJsonpmidi-generator"]||[]).push([[0],{105:function(e,t,n){},108:function(e,t,n){"use strict";n.r(t);var r=n(7),a=n(0),o=n.n(a),c=n(17),s=n.n(c),i=(n(87),n(10)),h=n(11),u=n(139),l=n(138),j=n(143),d=n(23),b=n(148),f=n(70),p=n.n(f);function m(e){var t=e.notes,n=Object(a.useState)([]),o=Object(h.a)(n,2),c=o[0],s=o[1];return Object(a.useEffect)((function(){for(var e=Math.max.apply(Math,Object(i.a)(t.notes.map((function(e){return Math.max.apply(Math,Object(i.a)(e))})))),n=Math.min.apply(Math,Object(i.a)(t.notes.map((function(e){return Math.min.apply(Math,Object(i.a)(e))})))),a=[],o=0,c=0;c<t.rythm.length;c++)o+=t.rythm[c];for(var h=0;h<t.notes.length;h++){for(var u=t.notes[h],l=[],j=n;j<=e;j++)u.includes(j)?l.push(Object(r.jsx)("div",{style:{height:(1/(e-n+1)*100).toString()+"%",width:"100%",backgroundColor:"#c62828"}},h.toString()+j.toString())):l.push(Object(r.jsx)("div",{style:{height:(1/(e-n+1)*100).toString()+"%",width:"100%"}},h.toString()+j.toString()));a.push(Object(r.jsx)("div",{style:{height:"100%",width:(t.rythm[h]/o*100).toString()+"%"},children:l.reverse()},h))}s(a)}),[t]),Object(r.jsx)(l.a,{className:"w-100 m-0 h-100",children:c})}var O=o.a.memo(m),g="ADD_SPECIMAN",x="SET_SPECIMAN_SCORE",v="DELETE_POPULATION",y=function(e){return{type:g,payload:{speciman:e}}},M=function(){return{type:v}};function w(e){var t=e.progression,n=e.index,a=Object(d.b)();return Object(r.jsxs)(u.a,{className:"p-0 h-100",children:[Object(r.jsxs)(l.a,{className:"w-100 m-0 h-75",children:[Object(r.jsx)(O,{color:"#c62828",notes:t}),Object(r.jsx)("div",{className:"vote",onClick:function(){t.play()},children:Object(r.jsx)(p.a,{style:{fontSize:80},className:"vote-text"})})]}),Object(r.jsxs)(l.a,{children:[Object(r.jsx)(j.a,{sm:3,children:Object(r.jsx)("small",{children:"Score"})}),Object(r.jsx)(j.a,{sm:1,className:"pl-2",children:Object(r.jsx)("small",{children:t.score})}),Object(r.jsx)(j.a,{className:"pl-2",children:Object(r.jsx)(b.a,{"aria-labelledby":"discrete-slider",valueLabelDisplay:"auto",min:0,max:100,onChange:function(e,t){a(function(e){var t=e.index,n=e.score;return{type:x,payload:{index:t,score:n}}}({index:n,score:t}))},value:t.score})})]})]})}var S=o.a.memo(w),N=n(144);var C=function(){var e=Object(d.c)((function(e){return e.population})),t=Object(a.useState)([]),n=Object(h.a)(t,2),o=n[0],c=n[1];return Object(a.useEffect)((function(){for(var t=Object(i.a)(e),n=[];t.length;)n.push(t.splice(0,4));c(n)}),[e]),Object(r.jsx)(N.a,{children:Object(r.jsx)(u.a,{children:o.map((function(e,t){return Object(r.jsx)(l.a,{children:e.map((function(e,n){return Object(r.jsx)(j.a,{style:{height:"200px"},children:Object(r.jsx)(S,{progression:e,index:4*t+n})},n)}))},t)}))})})},z=n(26),E=n(5),k=n(146),D=n(147),I=n(1),L=n(2),P=function e(t,n,r){Object(I.a)(this,e);var a=Object(i.a)(new Set(t.flat())),o=a.reduce((function(e,t){return e+t}))/a.length,c=n.reduce((function(e,t){return e+t}));this.scale=r,this.length=c,this.notes=a,this.switches=n.length,this.mean=o},A=[1/8,1/4,.5,3/4,1,1.5,2,3,4];function F(e,t){t=t-A.length+1;for(var n=0,r=[],a=0,o=Math.min(A.length-1+t,A.length-1),c=Math.max(t,0);n<e;){var s=0,i=Math.floor(Math.random()*(o-c))+c;if(Math.random()<.4&&0!==a?i=a:a=i,n+A[i]-s>e)return s=e-n,r.push({rythm:s,beginning:n}),n+=s,r;r.push({rythm:A[i]-s,beginning:n}),n+=A[i]-s}return r}var G=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],T=function(){function e(t,n,r){Object(I.a)(this,e),this.hight=t,this.start=n,this.end=n+r,this.duration=r;var a=Math.floor(t/12),o=G[t%12];this.note=o+a.toString()}return Object(L.a)(e,[{key:"existsInWindow",value:function(e){return e[0]>this.start&&e[0]<this.end||e[1]>this.start&&e[1]<=this.end}}]),e}(),W="major",R="minor",_={major:{notes:[0,2,4,5,7,9,11],mode:[W,R,R,W,W,R,R]}},B={major:[0,4,7,2,11,6,9,1,8,3,10,5],minor:[0,3,7,2,10,5,9,4,11,6,8,1]};function J(e,t,n,r){var a=_[t],o=Math.floor(Math.random()*a.notes.length),c=a.mode[o],s=a.notes[o];if(0===n)return{root:s+=36,chord:[]};var i=function(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,o=arguments.length>5?arguments[5]:void 0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=[],i=0,h=0;h<n;h++){var u=Math.floor(Math.random()*a+Math.floor(i/(2*a))),l=B[t][u];l+=e,Math.random()<u/(1+o)/12-c&&(l+=12),Math.random()<l/2*(1+o)/12-c&&0!==u&&(l-=12),!s.includes(l)&&r.includes(l%12)?(i=0,s.push(l)):(i++,h--)}return s}(s,c,n,a.notes,r,e).map((function(t){return t+12*(3+e)}));return Math.random()-1/4>s/12&&(s+=12),{chord:i,root:s+12}}var q=n(40),Q=new q.b(.2).toDestination(),U=new q.a({frequency:1e3,type:"lowpass",rolloff:-12,Q:0}).connect(Q),Y=new q.c(q.d,{oscillator:{count:2,spread:5,type:"sawtooth"},envelope:{attack:.002,decay:0,sustain:1,release:.1}}).connect(U);function H(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,a=[],o=[],c=[],s=F(8,n),h=Math.floor(12*Math.random()),u=function(n){var i=J(r,"major",t-1,e);o.push(i.root+h),a.push(i.chord.map((function(e){return e+h}))),i.chord.map((function(e){return c.push(new T(e+h,s[n].beginning,s[n].rythm))})),c.push(new T(i.root+h,s[n].beginning,s[n].rythm))},l=0;l<s.length;l++)u(l);a=a.map((function(e,t){return[].concat(Object(i.a)(a[t]),[o[t]])}));var j=new P(a,s,h);return new K({notes:a,rythm:s.map((function(e){return e.rythm})),genome:j,notes2:c})}var K=function(){function e(t){var n=t.notes,r=t.rythm,a=t.genome,o=t.notes2,c=t.score,s=void 0===c?10:c,i=t.roots,h=t.chords;Object(I.a)(this,e),this.roots=i,this.chords=h,this.notes=n,this.rythm=r,this.genome=a,this.notes2=o,this.score=s}return Object(L.a)(e,[{key:"play",value:function(){for(var e=q.e(),t=0;t<this.notes2.length;t++)Y.triggerAttack(this.notes2[t].note,e+this.notes2[t].start),Y.triggerRelease([this.notes2[t].note],e+this.notes2[t].end)}},{key:"transpose",value:function(t){var n=t-this.genome.scale,r=new P(this.notes,this.rythm,this.genome.scale+n),a=this.notes.map((function(e){return e.map((function(e){return e+n}))})),o=this.notes2.map((function(e){return new T(e.hight+n,e.start,e.duration)}));return new e(Object(E.a)(Object(E.a)({},this),{},{genome:r,notes:a,notes2:o}))}}]),e}();function V(e){var t=e.reduce((function(e,t){return e+t}));return e.map((function(e){return e/t}))}function X(e){for(var t=Math.random(),n=0,r=0;n<t;)n+=e[r],r++;return r-1}function Z(e,t){var n=Math.max(e.genome.scale,t.genome.scale),r=Math.min(e.genome.scale,t.genome.scale),a=Math.floor(Math.random()*(n-r))+r,o=e.transpose(a),c=t.transpose(a),s=function(e,t,n){var r=[],a=0,o=[e.map((function(e){return e.end})).sort(),t.map((function(e){return e.end})).sort()];for(;a<n;)for(var c=Math.round(Math.random()),s=0;s<o[c].length;s++){if(o[c][s]>a){r.push(o[c][s]-a),a=o[c][s];break}s===o[c].length-1&&(r.push(o[c][s]-a),a=o[c][s])}return r}(o.notes2,c.notes2,8);$(o);for(var u=function(e,t,n,r,a,o){for(var c=0,s=[],u=$(e),l=Object(h.a)(u,2),j=l[0],d=l[1],b=$(t),f=Object(h.a)(b,2),p=f[0],m=f[1],O=function(e){var t=[c,c+n[e]],h=[];j.map((function(e){return e.existsInWindow(t)?h.push(e.hight):null})),p.map((function(e){return e.existsInWindow(t)?h.push(e.hight):null})),h=Object(i.a)(new Set(h.flat()));var u=Math.floor(Math.random()*h.length),l=h[u];h=[],d.map((function(e){return e.existsInWindow(t)?h.push(e.hight):null})),m.map((function(e){return e.existsInWindow(t)?h.push(e.hight):null})),h=Object(i.a)(new Set(h.flat()));for(var b=_.major,f=(l-r)%12,O=b.mode[b.notes.indexOf(f)],g=[],x=0,v=0;v<a;v++){var y=h[Math.floor(Math.random()*h.length)];!g.includes(y)&&B[O].slice(0,o+Math.floor(x/(2*o))).includes((y-l)%12)?(x=0,g.push(y)):(x++,v--)}g.push(l),c+=n[e],s.push(g)},g=0;g<n.length;g++)O(g);return s}(o,c,s,a,e.notes[0].length-1,3),l=[],j=0,d=function(e){u[e].forEach((function(t){l.push(new T(t,j,s[e]))})),j+=s[e]},b=0;b<s.length;b++)d(b);var f=new P(u,s,a);return new K({notes:u,rythm:s,genome:f,notes2:l})}function $(e){for(var t=e.notes.map((function(e){return e[e.length-1]})),n=e.notes.map((function(e){return e.slice(0,e.length-1)})).flat(),r=[],a=[],o=0;o<e.notes2.length;o++)t.includes(e.notes2[o].hight)&&r.push(e.notes2[o]),n.includes(e.notes2[o].hight)&&a.push(e.notes2[o]);return[r,a]}var ee=function(e){var t=e.updateGeneration,n=Object(d.b)(),a=Object(d.c)((function(e){return e.population}));return Object(r.jsx)(D.a,{variant:"contained",color:"primary",onClick:function(){n(M()),function(e){for(var t=[],n=0;n<e.length;n++){var r=V(e.map((function(e){return e.score}))),a=X(r),o=X(r),c=Z(e[a],e[o]);t.push(c)}return t}(a).map((function(e){return n(y(e))})),t()},children:"Evolve"})};var te=function(){var e=Object(a.useState)(0),t=Object(h.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)({populationSize:8,jazziness:4,numberOfNotes:3,noteLengths:12}),s=Object(h.a)(c,2),i=s[0],b=s[1],f=Object(d.b)(),p=function(e){b(Object(E.a)(Object(E.a)({},i),{},Object(z.a)({},e.target.name,e.target.value)))},m=function(){o(0),f(M()),function(e,t,n,r){for(var a=[],o=0;o<e;o++)a.push(H(t,n,r));return a}(i.populationSize,i.jazziness,i.numberOfNotes,i.noteLengths).map((function(e){return f(y(e))}))};return Object(a.useEffect)((function(){m()}),[i]),Object(r.jsx)(N.a,{children:Object(r.jsxs)(u.a,{children:[Object(r.jsx)(l.a,{children:Object(r.jsxs)("h2",{children:["Generation: ",n]})}),Object(r.jsxs)(l.a,{className:"p-5",children:[Object(r.jsx)(j.a,{children:Object(r.jsx)(k.a,{name:"populationSize",label:"Population size",type:"number",onChange:p,value:i.populationSize})}),Object(r.jsx)(j.a,{children:Object(r.jsx)(k.a,{name:"jazziness",label:"Jazziness",type:"number",onChange:p,value:i.jazziness})}),Object(r.jsx)(j.a,{children:Object(r.jsx)(k.a,{name:"numberOfNotes",label:"Number of notes",type:"number",onChange:p,value:i.numberOfNotes})}),Object(r.jsx)(j.a,{children:Object(r.jsx)(k.a,{name:"noteLengths",label:"Note lengths",type:"number",onChange:p,value:i.noteLengths})})]}),Object(r.jsxs)(l.a,{children:[Object(r.jsx)(D.a,{variant:"contained",color:"primary",onClick:m,children:"Restart"}),Object(r.jsx)(ee,{updateGeneration:function(){o(n+1)}})]})]})})};var ne=function(){var e=Object(a.useState)(null),t=Object(h.a)(e,2),n=t[0],o=t[1],c=Object(d.c)((function(e){return e.population}));return Object(a.useEffect)((function(){c.length>1&&o(Z(c[0],c[1]))}),[c]),n?Object(r.jsx)(N.a,{children:Object(r.jsxs)(u.a,{children:[Object(r.jsx)(l.a,{className:"p-3",children:Object(r.jsx)(j.a,{children:Object(r.jsx)("h2",{children:"Debug"})})}),Object(r.jsx)(l.a,{className:"p-3",children:Object(r.jsx)("h4",{children:"Parent 1:"})}),Object(r.jsx)(l.a,{children:Object(r.jsx)(j.a,{style:{height:"300px"},children:Object(r.jsx)(S,{progression:c[0],index:0})})}),Object(r.jsx)(l.a,{className:"p-3",children:Object(r.jsx)("h4",{children:"Parent 2:"})}),Object(r.jsx)(l.a,{children:Object(r.jsx)(j.a,{style:{height:"300px"},children:Object(r.jsx)(S,{progression:c[1],index:1})})}),Object(r.jsx)(l.a,{className:"p-3",children:Object(r.jsx)("h4",{children:"Child:"})}),Object(r.jsx)(l.a,{children:Object(r.jsx)(j.a,{style:{height:"300px"},children:Object(r.jsx)(S,{progression:n})})})]})}):null},re=(n(105),n(74)),ae=n(20),oe=n(75),ce=n(145),se=Object(oe.a)({palette:{type:"dark",primary:{main:"#c62828"},secondary:{main:"#181a1b"}}});function ie(){return Object(r.jsxs)(ce.a,{theme:se,children:[Object(r.jsx)(te,{}),Object(r.jsx)(re.a,{children:Object(r.jsxs)(ae.c,{children:[Object(r.jsx)(ae.a,{path:"/test",children:Object(r.jsx)(ne,{})}),Object(r.jsx)(ae.a,{path:"/",children:Object(r.jsx)(C,{})})]})})]})}ie.whyDidYouRender=!0;var he=ie,ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,149)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))},le=(n(107),n(46)),je=[],de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return[].concat(Object(i.a)(e),[t.payload.speciman]);case v:return[];case x:return e.map((function(e,n){return n!==t.payload.index?e:new K(Object(E.a)(Object(E.a)({},e),{},{score:t.payload.score}))}));default:return e}},be=Object(le.b)({population:de}),fe=Object(le.c)(be);s.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(d.a,{store:fe,children:Object(r.jsx)(he,{})})}),document.getElementById("root")),ue()},87:function(e,t,n){}},[[108,1,2]]]);
//# sourceMappingURL=main.08cf9c07.chunk.js.map