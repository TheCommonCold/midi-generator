(this["webpackJsonpmidi-generator"]=this["webpackJsonpmidi-generator"]||[]).push([[0],{105:function(t,e,n){},108:function(t,e,n){"use strict";n.r(e);var r=n(7),o=n(0),a=n.n(o),c=n(17),i=n.n(c),s=(n(87),n(10)),h=n(11),u=n(139),l=n(138),j=n(143),d=n(23),b=n(148),f=n(70),m=n.n(f);function p(t){var e=t.progression,n=Object(o.useState)([]),a=Object(h.a)(n,2),c=a[0],i=a[1];return Object(o.useEffect)((function(){for(var t=Math.max.apply(Math,Object(s.a)(e.notes.map((function(t){return Math.max.apply(Math,Object(s.a)(t.chord.map((function(t){return t.hight}))).concat([t.root.hight]))})))),n=Math.min.apply(Math,Object(s.a)(e.notes.map((function(t){return Math.min.apply(Math,Object(s.a)(t.chord.map((function(t){return t.hight}))).concat([t.root.hight]))})))),o=[],a=0,c=0;c<e.rythm.length;c++)a+=e.rythm[c];for(var h=0;h<e.notes.length;h++){for(var u=[].concat(Object(s.a)(e.notes[h].chord),[e.notes[h].root]).map((function(t){return t.hight})),l=[],j=n;j<=t;j++)u.includes(j)?l.push(Object(r.jsx)("div",{style:{height:(1/(t-n+1)*100).toString()+"%",width:"100%",backgroundColor:"#c62828"}},h.toString()+j.toString())):l.push(Object(r.jsx)("div",{style:{height:(1/(t-n+1)*100).toString()+"%",width:"100%"}},h.toString()+j.toString()));o.push(Object(r.jsx)("div",{style:{height:"100%",width:(e.rythm[h]/a*100).toString()+"%"},children:l.reverse()},h))}i(o)}),[e]),Object(r.jsx)(l.a,{className:"w-100 m-0 h-100",children:c})}var O=a.a.memo(p),g="ADD_SPECIMAN",x="SET_SPECIMAN_SCORE",v="DELETE_POPULATION",y=function(t){return{type:g,payload:{speciman:t}}},M=function(){return{type:v}};function w(t){var e=t.progression,n=t.index,o=Object(d.b)();return Object(r.jsxs)(u.a,{className:"p-0 h-100",children:[Object(r.jsxs)(l.a,{className:"w-100 m-0 h-75",children:[Object(r.jsx)(O,{color:"#c62828",progression:e}),Object(r.jsx)("div",{className:"vote",onClick:function(){e.play()},children:Object(r.jsx)(m.a,{style:{fontSize:80},className:"vote-text"})})]}),Object(r.jsxs)(l.a,{children:[Object(r.jsx)(j.a,{sm:3,children:Object(r.jsx)("small",{children:"Score"})}),Object(r.jsx)(j.a,{sm:1,className:"pl-2",children:Object(r.jsx)("small",{children:e.score})}),Object(r.jsx)(j.a,{className:"pl-2",children:Object(r.jsx)(b.a,{"aria-labelledby":"discrete-slider",valueLabelDisplay:"auto",min:0,max:100,onChange:function(t,e){o(function(t){var e=t.index,n=t.score;return{type:x,payload:{index:e,score:n}}}({index:n,score:e}))},value:e.score})})]})]})}var S=a.a.memo(w),N=n(144);var E=function(){var t=Object(d.c)((function(t){return t.population})),e=Object(o.useState)([]),n=Object(h.a)(e,2),a=n[0],c=n[1];return Object(o.useEffect)((function(){for(var e=Object(s.a)(t),n=[];e.length;)n.push(e.splice(0,4));c(n)}),[t]),Object(r.jsx)(N.a,{children:Object(r.jsx)(u.a,{children:a.map((function(t,e){return Object(r.jsx)(l.a,{children:t.map((function(t,n){return Object(r.jsx)(j.a,{style:{height:"200px"},children:Object(r.jsx)(S,{progression:t,index:4*e+n})},n)}))},e)}))})})},C=n(26),z=n(5),k=n(146),A=n(147),D=n(1),I=n(2),L=function t(e,n,r){Object(D.a)(this,t);var o=e.map((function(t){return t.chord}));o.flat()||(o=e.map((function(t){return t.root})));var a=Object(s.a)(new Set(o.flat())),c=a.reduce((function(t,e){return t+e}))/a.length,i=n.reduce((function(t,e){return t+e}));this.scale=r,this.length=i,this.notes=a,this.switches=n.length,this.mean=c},P=[1/8,1/4,.5,3/4,1,1.5,2,3,4];function F(t,e){e=e-P.length+1;for(var n=0,r=[],o=0,a=Math.min(P.length-1+e,P.length-1),c=Math.max(e,0);n<t;){var i=0,s=Math.floor(Math.random()*(a-c))+c;if(Math.random()<.4&&0!==o?s=o:o=s,n+P[s]-i>t)return i=t-n,r.push({rythm:i,beginning:n}),n+=i,r;r.push({rythm:P[s]-i,beginning:n}),n+=P[s]-i}return r}var G=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],T=function(){function t(e,n,r){Object(D.a)(this,t),this.hight=e,this.start=n,this.end=n+r,this.duration=r;var o=Math.floor(e/12),a=G[e%12];this.note=a+o.toString()}return Object(I.a)(t,[{key:"existsInWindow",value:function(t){return t[0]>this.start&&t[0]<this.end||t[1]>this.start&&t[1]<=this.end}}]),t}(),W="major",R="minor",_={major:{notes:[0,2,4,5,7,9,11],mode:[W,R,R,W,W,R,R]}},B={major:[0,4,7,2,11,6,9,1,8,3,10,5],minor:[0,3,7,2,10,5,9,4,11,6,8,1]};function J(t,e,n,r){var o=_[e],a=Math.floor(Math.random()*o.notes.length),c=o.mode[a],i=o.notes[a];if(0===n)return{root:i+=36,chord:[]};var s=function(t,e,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,a=arguments.length>5?arguments[5]:void 0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,i=[],s=0,h=0;h<n;h++){var u=Math.floor(Math.random()*o+Math.floor(s/(2*o))),l=B[e][u];l+=t,Math.random()<u/(1+a)/12-c&&(l+=12),Math.random()<l/2*(1+a)/12-c&&0!==u&&(l-=12),!i.includes(l)&&r.includes(l%12)?(s=0,i.push(l)):(s++,h--)}return i}(i,c,n,o.notes,r,t).map((function(e){return e+12*(3+t)}));return Math.random()-1/4>i/12&&(i+=12),{chord:s,root:i+12}}var q=n(40),Q=new q.b(.2).toDestination(),U=new q.a({frequency:1e3,type:"lowpass",rolloff:-12,Q:0}).connect(Q),Y=new q.c(q.d,{oscillator:{count:2,spread:5,type:"sawtooth"},envelope:{attack:.002,decay:0,sustain:1,release:.1}}).connect(U);function H(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,o=[],a=F(8,n),c=Math.floor(12*Math.random()),i=function(n){var i=J(r,"major",e-1,t);o.push({chord:i.chord.map((function(t){return new T(t+c,a[n].beginning,a[n].rythm)})),root:new T(i.root+c,a[n].beginning,a[n].rythm)})},s=0;s<a.length;s++)i(s);var h=new L(o,a,c);return new K({notes:o,rythm:a.map((function(t){return t.rythm})),genome:h})}var K=function(){function t(e){var n=e.rythm,r=e.genome,o=e.score,a=void 0===o?10:o,c=e.notes;Object(D.a)(this,t),this.notes=c,this.rythm=n,this.genome=r,this.score=a}return Object(I.a)(t,[{key:"getAllNotes",value:function(){return this.notes.map((function(t){return[].concat(Object(s.a)(t.chord),[t.root])})).flat()}},{key:"play",value:function(){for(var t=this.getAllNotes(),e=q.e(),n=0;n<t.length;n++)Y.triggerAttack(t[n].note,e+t[n].start),Y.triggerRelease([t[n].note],e+t[n].end)}},{key:"transpose",value:function(e){var n=e-this.genome.scale,r=this.notes.map((function(t){return{chord:t.chord.map((function(t){return new T(t.hight+n,t.start,t.duration)})),root:new T(t.root.hight+n,t.root.start,t.root.duration)}})),o=new L(r,this.rythm,this.genome.scale+n);return new t(Object(z.a)(Object(z.a)({},this),{},{genome:o,notes:r}))}}]),t}();function V(t){var e=t.reduce((function(t,e){return t+e}));return t.map((function(t){return t/e}))}function X(t){for(var e=Math.random(),n=0,r=0;n<e;)n+=t[r],r++;return r-1}function Z(t,e){for(var n=Math.max(t.genome.scale,e.genome.scale),r=Math.min(t.genome.scale,e.genome.scale),o=Math.floor(Math.random()*(n-r))+r,a=t.transpose(o),c=e.transpose(o),i=function(t,e,n){var r=[],o=0,a=[t.map((function(t){return t.end})).sort(),e.map((function(t){return t.end})).sort()];for(;o<n;)for(var c=Math.round(Math.random()),i=0;i<a[c].length;i++){if(a[c][i]>o){r.push(a[c][i]-o),o=a[c][i];break}i===a[c].length-1&&(r.push(a[c][i]-o),o=a[c][i])}return r}(a.getAllNotes(),c.getAllNotes(),8),h=function(t,e,n,r,o,a){for(var c=0,i=[],h=function(h){var u=[c,c+n[h]],l=[];t.notes.forEach((function(t){return t.root.existsInWindow(u)?l.push(t.root):null})),e.notes.forEach((function(t){return t.root.existsInWindow(u)?l.push(t.root):null})),l=Object(s.a)(new Set(l));var j=Math.floor(Math.random()*l.length),d=l[j].hight;l=[],e.notes.forEach((function(t){t.chord.forEach((function(t){return t.existsInWindow(u)?l.push(t):null}))})),t.notes.forEach((function(t){t.chord.forEach((function(t){return t.existsInWindow(u)?l.push(t):null}))})),l=Object(s.a)(new Set(l));for(var b=_.major,f=(d-r)%12,m=b.mode[b.notes.indexOf(f)],p=[],O=0,g=0;g<o;g++){var x=l[Math.floor(Math.random()*l.length)].hight;!p.includes(x)&&B[m].slice(0,a+Math.floor(O/(2*a))).includes((x-d)%12)?(O=0,p.push(x)):(O++,g--)}i.push({chord:p,root:d}),c+=n[h]},u=0;u<n.length;u++)h(u);return i}(a,c,i,o,t.notes[0].chord.length,3),u=[],l=0,j=function(t){var e=h[t];u.push({chord:e.chord.map((function(e){return new T(e,l,i[t])})),root:new T(e.root,l,i[t])}),l+=i[t]},d=0;d<i.length;d++)j(d);var b=new L(u,i,o);return new K({notes:u,rythm:i,genome:b})}var $=function(t){var e=t.updateGeneration,n=Object(d.b)(),o=Object(d.c)((function(t){return t.population}));return Object(r.jsx)(A.a,{variant:"contained",color:"primary",onClick:function(){n(M()),function(t){for(var e=[],n=0;n<t.length;n++){var r=V(t.map((function(t){return t.score}))),o=X(r),a=X(r),c=Z(t[o],t[a]);e.push(c)}return e}(o).map((function(t){return n(y(t))})),e()},children:"Evolve"})};var tt=function(){var t=Object(o.useState)(0),e=Object(h.a)(t,2),n=e[0],a=e[1],c=Object(o.useState)({populationSize:8,jazziness:4,numberOfNotes:3,noteLengths:12}),i=Object(h.a)(c,2),s=i[0],b=i[1],f=Object(d.b)(),m=function(t){b(Object(z.a)(Object(z.a)({},s),{},Object(C.a)({},t.target.name,t.target.value)))},p=function(){a(0),f(M()),function(t,e,n,r){for(var o=[],a=0;a<t;a++)o.push(H(e,n,r));return o}(s.populationSize,s.jazziness,s.numberOfNotes,s.noteLengths).map((function(t){return f(y(t))}))};return Object(o.useEffect)((function(){p()}),[s]),Object(r.jsx)(N.a,{children:Object(r.jsxs)(u.a,{children:[Object(r.jsx)(l.a,{children:Object(r.jsxs)("h2",{children:["Generation: ",n]})}),Object(r.jsxs)(l.a,{className:"p-5",children:[Object(r.jsx)(j.a,{children:Object(r.jsx)(k.a,{name:"populationSize",label:"Population size",type:"number",onChange:m,value:s.populationSize})}),Object(r.jsx)(j.a,{children:Object(r.jsx)(k.a,{name:"jazziness",label:"Jazziness",type:"number",onChange:m,value:s.jazziness})}),Object(r.jsx)(j.a,{children:Object(r.jsx)(k.a,{name:"numberOfNotes",label:"Number of notes",type:"number",onChange:m,value:s.numberOfNotes})}),Object(r.jsx)(j.a,{children:Object(r.jsx)(k.a,{name:"noteLengths",label:"Note lengths",type:"number",onChange:m,value:s.noteLengths})})]}),Object(r.jsxs)(l.a,{children:[Object(r.jsx)(A.a,{variant:"contained",color:"primary",onClick:p,children:"Restart"}),Object(r.jsx)($,{updateGeneration:function(){a(n+1)}})]})]})})};var et=function(){var t=Object(o.useState)(null),e=Object(h.a)(t,2),n=e[0],a=e[1],c=Object(d.c)((function(t){return t.population}));return Object(o.useEffect)((function(){c.length>1&&a(Z(c[0],c[1]))}),[c]),n?Object(r.jsx)(N.a,{children:Object(r.jsxs)(u.a,{children:[Object(r.jsx)(l.a,{className:"p-3",children:Object(r.jsx)(j.a,{children:Object(r.jsx)("h2",{children:"Debug"})})}),Object(r.jsx)(l.a,{className:"p-3",children:Object(r.jsx)("h4",{children:"Parent 1:"})}),Object(r.jsx)(l.a,{children:Object(r.jsx)(j.a,{style:{height:"300px"},children:Object(r.jsx)(S,{progression:c[0],index:0})})}),Object(r.jsx)(l.a,{className:"p-3",children:Object(r.jsx)("h4",{children:"Parent 2:"})}),Object(r.jsx)(l.a,{children:Object(r.jsx)(j.a,{style:{height:"300px"},children:Object(r.jsx)(S,{progression:c[1],index:1})})}),Object(r.jsx)(l.a,{className:"p-3",children:Object(r.jsx)("h4",{children:"Child:"})}),Object(r.jsx)(l.a,{children:Object(r.jsx)(j.a,{style:{height:"300px"},children:Object(r.jsx)(S,{progression:n})})})]})}):null},nt=(n(105),n(74)),rt=n(20),ot=n(75),at=n(145),ct=Object(ot.a)({palette:{type:"dark",primary:{main:"#c62828"},secondary:{main:"#181a1b"}}});function it(){return Object(r.jsxs)(at.a,{theme:ct,children:[Object(r.jsx)(tt,{}),Object(r.jsx)(nt.a,{children:Object(r.jsxs)(rt.c,{children:[Object(r.jsx)(rt.a,{path:"/test",children:Object(r.jsx)(et,{})}),Object(r.jsx)(rt.a,{path:"/",children:Object(r.jsx)(E,{})})]})})]})}it.whyDidYouRender=!0;var st=it,ht=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,149)).then((function(e){var n=e.getCLS,r=e.getFID,o=e.getFCP,a=e.getLCP,c=e.getTTFB;n(t),r(t),o(t),a(t),c(t)}))},ut=(n(107),n(46)),lt=[],jt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case g:return[].concat(Object(s.a)(t),[e.payload.speciman]);case v:return[];case x:return t.map((function(t,n){return n!==e.payload.index?t:new K(Object(z.a)(Object(z.a)({},t),{},{score:e.payload.score}))}));default:return t}},dt=Object(ut.b)({population:jt}),bt=Object(ut.c)(dt);i.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(d.a,{store:bt,children:Object(r.jsx)(st,{})})}),document.getElementById("root")),ht()},87:function(t,e,n){}},[[108,1,2]]]);
//# sourceMappingURL=main.ab5eb35b.chunk.js.map